{% extends 'base.html' %}{% load staticfiles %}{% block title %}课程教学网--交流社区{% endblock %}{% block custom_bread %}{% endblock %}{% block content %}<section>    <div class="container-fluid guestbook_message">        <div class="col-md-3 guestbook-left">             <div class=" myself">                 <dl>                     {% if request.user.is_authenticated %}                         <dd><img class="img-circle" src=" {{ MEDIA_URL }}{{ request.user.image }} "></dd>                             <dt>昵&nbsp;&nbsp;称:&nbsp;&nbsp;&nbsp;{{ request.user.nick_name}}</dt>                             <dt>姓&nbsp;&nbsp;名:&nbsp;&nbsp;&nbsp;{{ request.user}}</dt>                     {% else %}                         <img  class="img-thumbnail" src="{% static 'images/1.jpg' %}">                    {% endif %}                </dl>            </div>            <div class="guestbook">                <form id="guestbook_search" method="get" action="{% url 'guestbook:search' %}"  >                    <input type="text" class="fl"  placeholder="请输入搜索内容" name="q" required>                    <button type="submit"  id="search_btn" style="width: 30px;height: 30px; border: none; margin-top: 9.4%">                        <img class="search_btn fr" src="{% static 'images/search_btn.png' %}"/></button>                    {% csrf_token %}                </form>                <h3>热门话题</h3>                <ul>                    {% for guestbook in hot_guestbook %}                    <li><a href="{% url 'guestbook:guestbook_detail' guestbook.id %}">{{guestbook.title}}</a></li>                    {% endfor %}                </ul>            </div>        </div>        <div class="row col-md-8 guestbook-right">            <div class="guestbook_content">                <form id="publish_guestbook" method="post" action="{% url 'guestbook:publish_guestbook' %}">                    <input type='hidden' name='csrfmiddlewaretoken' value='gTZljXgnpvxn0fKZ1XkWrM1PrCGSjiCZ' />                    <h2>留言发表<label>标题：<input type="text" name="title" id="guestbook_title"/></label></h2>                    <textarea  id="editor" name="content" placeholder="有什么问题都可以在此处提出！！！"></textarea>                    <div class="guestbook_more">                        <label>发布时间：<input type="date" name="date" id="guestbook_date"/></label>                        <input id="publish" class="btn btn-info" type="submit" placeholder="发表" value="发表">                    </div>                    {% csrf_token %}                </form>            </div>            <div class="guestbook_list">                <div class="edit">                    <h2>留言列表</h2>                    <div class="sort">                        <ul>                            <li>                                <span  class="contents col-md-9">留言内容 </span>                                <span class="time col-md-1">TIME</span>                            </li>                            {% for guestbook in all_guestbook.object_list %}                            <li>                                <span class="contents col-md-10">                                    <a href="{% url 'guestbook:guestbook_detail' guestbook.id %}">{{ guestbook.g_content }}</a>                                </span>                                <span class="time col-md-1">{{ guestbook.g_time}}</span>                            </li>                            {% endfor %}                        </ul>                        <div class="pageturn">                            <ul class="pagelist">                                {% if  all_guestbook.has_previous %}                                    <li class="long"><a href="?{{ all_guestbook.previous_page_number.querystring }}">上一页</a></li>                                {% endif %}                                {% for page in  all_guestbook.pages %}                                    {% if page %}                                        {% ifequal page all_guestbook.number %}                                            <li class="active"><a href="?{{ page.querystring }}">{{ page }}</a></li>                                        {% else %}                                            <li><a href="?{{ page.querystring }}" class="page">{{ page }}</a></li>                                        {% endifequal %}                                    {% else %}                                        <li class="none"><a href="">...</a></li>                                    {% endif %}                                {% endfor %}                                {% if  all_guestbook.has_next %}                                    <li class="long"><a href="?{{ all_guestbook.next_page_number.querystring }}">下一页</a></li>                                {% endif %}                            </ul>                        </div>                    </div>                </div>            </div>        </div>    </div></section>{% endblock %}{% block custom_js %}<script src="/static/js/editor/kindeditor/kindeditor-all-min.js"></script><script src="/static/js/editor/kindeditor/lang/zh-CN.js"></script><script src="/static/js/editor/kindeditor/themes/default/default.css"></script><script>    var editor;    KindEditor.ready(function (k) {        editor = k.create('#editor' ,{            afterBlur: function(){                this.sync();            }        });    });     //留言的发表    $('#publish').on('click', function () {        var content =  $('#editor').val();        var title = $('#guestbook_title').val();        var date = $('#guestbook_date').val();        if(title == ""){            alert("留言标题不能为空");        }        if(content == ""){            alert("留言内容不能为空");        }        if(date == ""){            alert("留言时间不能为空");        }        $.ajax({            cacha: false,            type: "post",            url: "../publish_guestbook/",            async: true,            data:$('#publish_guestbook').serialize(),            success: function (data) {                if(data.status == 'success'){                    alert(data.msg);                    window.location.reload()                }else if(data.status == 'fail'){                    if(data.msg == '用户未登录'){                        window.location.href = '/login/'                    }else{                        alert(data.msg);                        window.location.reload()                    }                }            }        });    });</script>{% endblock %}