{% extends 'base.html' %}{% load staticfiles %}{% load custom %}{% block title %}课程教学网--留言{% endblock %}{% block custom_bread %}<section>    <div class="wp">        <ul class="crumbs">            <li><a href="{% url 'index' %}">首页</a>></li>            <li><a href="{% url 'guestbook:guestbook' %}">交流社区</a>></li>            <li>留言详情</li>        </ul>    </div></section><section>    <div class="guestbook_reply">        <ul>            <li class="guestbook_img"><img class="img-circle" src='{{ MEDIA_URL }}{{ guestbook.user.image }}' width='50' height='50'/></li>            <li class="guestbook_name">{{guestbook.user.username}}</li>            <li class="guestbook_time">{{guestbook.g_time}}</li>            <li class="reply"><button onclick="show()" style="border: none;background-color: initial;color: #02bbdc">回复</button></li>        </ul>        <div class="guestbook_contents">            <p>{{guestbook.g_content}}</p>        </div>        <div class="reply_content" id="reply">            <form id="reply_content" method="post" action=" " onsubmit="return false">                <input type="hidden" value="{{guestbook.id}}" id="id" name="id">                <textarea id="js-pl-textarea" name="reply_content" placeholder="来说点啥呗！！！" ></textarea>                <div class="guestbook_more" style="margin-top: -2px;">                    <input id="guestbook-reply" class="btn btn-info" type="submit" placeholder="发表回复" value="发表回复">                    <label style="margin-left: 66%">发布时间：<input type="date" name="date" id="guestbook_date"/></label>                </div>                {% csrf_token %}            </form>        </div>        <div class="reply_list" >            {% build_reply_tree reply_tree %}            <div class="pageturn">                <ul class="pagelist">                    {% if  all_reply.has_previous %}                        <li class="long"><a href="?{{ all_reply.previous_page_number.querystring }}">上一页</a></li>                    {% endif %}                    {% for page in  all_reply.pages %}                        {% if page %}                            {% ifequal page all_reply.number %}                                <li class="active"><a href="?{{ page.querystring }}">{{ page }}</a></li>                            {% else %}                                <li><a href="?{{ page.querystring }}" class="page">{{ page }}</a></li>                            {% endifequal %}                        {% else %}                            <li class="none"><a href="">...</a></li>                        {% endif %}                    {% endfor %}                    {% if  all_reply.has_next %}                        <li class="long"><a href="?{{ all_reply.next_page_number.querystring }}">下一页</a></li>                    {% endif %}                </ul>            </div>        </div>    </div></section>{% endblock %}{% block custom_js %}<script>function show() {    $('#reply').show();}function onshow(e) {    var id="re-reply-"+e;    $('#'+id).show();}$(function() {    $('#guestbook-reply').on('click', function () {        var content = $('#js-pl-textarea').val();        var date = $('#guestbook_date').val();        var id = $('#id').val();        if(content==""){            alert("回复内容不能为空！");            return false        }        if(date==""){            alert("回复日期不能为空！");            return false        }        $.ajax({            cache: false,            type: 'post',            dataType: 'json',            url: "../../reply/" ,            async: true,            data: $('#reply_content').serialize(),            success: function (data) {                if (data.status == 'success') {                    alert(data.msg);                    window.location.reload()                } else if (data.status == 'fail') {                    if (data.msg == '用户未登录') {                        window.location.href = '/login/'                    } else {                        alert(data.msg);                        window.location.reload()                    }                }            }        });    });});function onReply(e){    $.ajaxSetup({        headers: {            "X-CSRFToken": '{{ ' +            'csrf_token }}'        }    });    var form_id = 'reply_content-' + e;    var textarea_id = 'textarea-' + e;    var date_id = 'date-' + e;    var guestbook_id = {{guestbook.id}}    var content = $('#'+textarea_id).val();    var date = $('#'+date_id).val();    if(content==""){        alert("回复内容不能为空！");        return false    }    if(date==""){        alert("回复日期不能为空！");        return false    }    $.ajax({        cache: false,        type: 'get',        dataType: 'json',        url: "../../reply_reply/?id="+guestbook_id ,        async: true,        data: $('#'+form_id).serialize(),        success: function (data) {            if (data.status == 'success') {                alert(data.msg);                window.location.reload()            } else if (data.status == 'fail') {                if (data.msg == '用户未登录') {                    window.location.href = '/login/'                } else {                    alert(data.msg);                    window.location.reload()                }            }        }    });}</script>{% endblock %}