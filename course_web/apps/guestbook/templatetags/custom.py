from django import templatefrom django.utils.safestring import mark_saferegister = template.Library()def recurive_build_tree(html_ele, tree, indent , var):    html = ""    for k, v in tree.items():        row = '''            <div class="reply_box" style="margin-left:%spx;">                <ul>                    <li class="reply_img"><img class="img-circle" src='/media/%s' width='40' height='40'/></li>                    <li style="margin-left:15px;">%s</li>                    <li style="margin-top:25px;margin-left:-42px;">%s</li>                    <li style="margin-left:%spx;margin-top:24px" ><button onclick="onshow(%s)" style="border: none;background-color: initial;color: #02bbdc">回复</button></li>                </ul>                <div style="border-bottom:1px dashed  #bcbaba; padding-bottom:10px; padding-top:50px;margin-left:6%%">                    <p>%s</p>                </div>                    <div class="reply_content" id="re-reply-%s" style="width: 94%%; margin-top: 3%%; margin-left: 6%%">                        <form  id="reply_content-%s" method="get" action=" ">                            <input type="hidden" value="%s" id="reply_id" name="reply_id">                            <textarea id="textarea-%s" name="reply_content" placeholder="来说点啥呗！！！" ></textarea>                            <div class="guestbook_more" style="margin-top: -2px;">                                <input style="width: 90px" id="guestbook-reply-%s" type="button" class="btn btn-info" onclick="onReply(%s)"  placeholder="发表回复" value="发表回复">                                <label style="margin-left: 60%%">发布时间：<input type="date" name="date" id="date-%s"/></label>                            </div>                        </form>                    </div>            </div>        '''%(indent, k.user.image, k.user.username, k.r_time, var, k.id, k.r_content, k.id, k.id, k.id, k.id, k.id, k.id, k.id)        html_ele += row        if v:            html_ele = recurive_build_tree(html_ele, tree[k], indent+40, var-40)    return html_ele@register.simple_tagdef build_reply_tree(reply_tree):    html_ele = ""    for k,v in reply_tree.items():        row = '''        <div class='reply_box'>             <ul>                <li class="reply_img"><img class="img-circle" src='/media/%s' width='40' height='40'/></li>                <li class="reply_name">%s</li>                <li class="reply_time">%s</li>                <li class="re-reply"><button onclick="onshow(%s)" style="border: none;background-color: initial;color: #02bbdc">回复</button></li>            </ul>            <div class="reply_contents">                <p>%s</p>            </div>                <div class="reply_content" id="re-reply-%s" style="width: 94%%; margin-top: 3%%; margin-left: 6%%">                    <form  id="reply_content-%s" method="post" action=" ">                        <input type="hidden" value="%s" id="reply_id" name="reply_id">                        <textarea id="textarea-%s" name="reply_content" placeholder="来说点啥呗！！！" ></textarea>                        <div class="guestbook_more" style="margin-top: -2px;">                            <input style="width: 90px" id="guestbook-reply-%s" type="button" class="btn btn-info" onclick="onReply(%s)"  placeholder="发表回复" value="发表回复">                            <label style="margin-left: 64%%">发布时间：<input type="date" name="date" id="date-%s"/></label>                        </div>                    </form>                </div>            </div>        ''' % (k.user.image,k.user.username,k.r_time,k.id,k.r_content,k.id,k.id,k.id,k.id,k.id,k.id,k.id)        html_ele += row        if v:            html_ele = recurive_build_tree(html_ele,reply_tree[k],40,690)    return mark_safe(html_ele)